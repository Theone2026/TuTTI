<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cerrando Sesión - TuTTi</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8 text-center">
        <h1 class="text-3xl font-bold mb-4">Cerrando Sesión...</h1>
        <p class="text-gray-600">Por favor, espera mientras te redirigimos.</p>
    </div>

    <script>
        async function logout() {
            // Eliminar todos los datos de sesión del localStorage
            localStorage.removeItem('authToken');
            localStorage.removeItem('userId');
            localStorage.removeItem('userEmail');
            localStorage.removeItem('userName');
            localStorage.removeItem('userLoggedIn');

            try {
                // Hacer una petición al servidor para invalidar la sesión
                const response = await fetch('/api/logout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('authToken')}`
                    }
                });

                if (!response.ok) {
                    throw new Error('Error al cerrar sesión en el servidor');
                }
            } catch (error) {
                console.error('Error durante el cierre de sesión:', error);
            } finally {
                // Redirigir al usuario a la página principal
                window.location.href = '/';
            }
        }

        // Ejecutar la función de cierre de sesión inmediatamente
        logout();
    </script>
</body>
</html>